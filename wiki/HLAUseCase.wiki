#summary Using the genotype list service with IMGT/HLA Database nomenclature.

=== Summary ===

The primary use case for the IDAWG Genotype List service is to support the registering of resources adhering to the [http://www.ebi.ac.uk/ipd/imgt/hla/ IMGT/HLA Database] nomenclature.


<br/>
=== Configure nomenclature ===

Support for IMGT/HLA Database nomenclature is provided by the service and is configured at compile time.  In the {{{gl-service-spark}}} module a specific version of the nomenclature is bound to the {{{Nomenclature}}} class in [http://code.google.com/p/genotype-list/source/browse/trunk/gl-service-spark/src/main/java/org/immunogenomics/gl/service/spark/SparkModule.java SparkModule.java].  For example, for IMGT/HLA Database version 3.10.0

{{{
@Override
protected void configure() {
  bind(Nomenclature.class).to(ImgtHla3_10_0.class);
  // ...
}
}}}


<br/>
=== Load loci and alleles ===

To load loci and alleles from the bound nomenclature (version 3.10.0 in this case), either

{{{
$ curl -X post http://localhost:10080/gl/load
}}}

or visit

{{{
http://localhost:10080/gl
}}}

in a web browser and hit the Load IMGT/HLA Database version 3.10.0 alleles button.


<br/>
=== Retrieve resources ===

To retrieve a resource identified by a URI, use HTTP GET

{{{
$ wget -q -O - http://localhost:10080/gl/locus/0.gls && echo
HLA-A
}}}

<br/>
The file extension determines the content type of the response.

{{{
$ wget -q -O - http://localhost:10080/gl/locus/0.html && echo
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>http://localhost:10080/gl/locus/0</title>
  </head>
  <body>
    <p class="type">
<a href="http://immunogenomics.org/gl-ontology/Locus">http://immunogenomics.org/gl-ontology/Locus</a>
    </p>
    <p class="title">http://localhost:10080/gl/locus/0</p>
    <p class="identifier">http://localhost:10080/gl/locus/0</p>
    <p class="label">http://localhost:10080/gl/locus/0</p>
    <p class="comment">A locus represented by glstring HLA-A</p>
    <p class="hasGlstring">HLA-A</p>
  </body>
</html>
}}}

<br/>
{{{
$ wget -q -O - http://localhost:10080/gl/locus/0.rdf && echo
<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:gl="http://immunogenomics.org/gl-ontology/1.0"
  xmlns:owl="http://www.w3.org/2002/07/owl#"
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
>
  <rdf:Description rdf:about="http://localhost:10080/gl/locus/0">
    <rdf:type rdf:resource="http://immunogenomics.org/gl-ontology/Locus"/>
    <dc:title>http://localhost:10080/gl/locus/0</dc:title>
    <dc:identifier>http://localhost:10080/gl/locus/0</dc:identifier>
    <rdfs:label>http://localhost:10080/gl/locus/0</rdfs:label>
    <rdfs:comment>A locus represented by glstring HLA-A</rdfs:comment>
    <gl:hasGlstring>HLA-A</gl:hasGlstring>
  </rdf:Description>
</rdf:RDF>
}}}

<br/>
{{{
$ wget -q -O - http://localhost:10080/gl/locus/0.n3 && echo
@prefix dc: <http://purl.org/dc/elements/1.1/> .
@prefix gl: <http://immunogenomics.org/gl-ontology/1.0/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

<http://localhost:10080/gl/locus/0> a <http://immunogenomics.org/gl-ontology/Locus> ;
  dc:title "http://localhost:10080/gl/locus/0" ;
  dc:identifier "http://localhost:10080/gl/locus/0" ;
  rdfs:label "http://localhost:10080/gl/locus/0" ;
  rdfs:comment "A locus represented by glstring HLA-A" ;
  gl:hasGlstring "HLA-A" ;
}}}

<br/>
=== Register resources ===

To register a new resource described by a glstring, use HTTP POST
{{{
$ curl --header "content-type: text/plain" \
       --data "HLA-A*01:01:01:01/HLA-A*01:01:01:02N" \
       -X POST http://localhost:10080/gl/allele-list -v && echo
* About to connect() to localhost port 10080 (#0)
*   Trying 127.0.0.1... connected
* Connected to localhost (127.0.0.1) port 10080 (#0)
> POST /gl/allele-list HTTP/1.1
> User-Agent: curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8r zlib/1.2.3
> Host: localhost:10080
> Accept: */*
> content-type: text/plain
> Content-Length: 36
>
< HTTP/1.1 201 Created
< Date: Tue, 12 Jun 2012 20:54:55 GMT
< Content-Type: text/plain
< Location: http://localhost:10080/gl/allele-list/0
< Content-Length: 36
< Server: Jetty(8.1.3.v20120416)
<
* Connection #0 to host localhost left intact
* Closing connection #0
HLA-A*01:01:01:01/HLA-A*01:01:01:02N
}}}

The URI for the newly created resource is returned as the Location in the response header.

<br/>
Other examples

<br/>
{{{
$ curl --header "content-type: text/plain" \
       --data "HLA-A*01:01:01:01/HLA-A*01:01:01:02N"
       -X POST http://localhost:10080/gl/allele-list -v && echo
}}}

<br/>
{{{
$ curl --header "content-type: text/plain" \
       --data "HLA-DRB1*08:30:02~HLA-DRB3*02:02:01:01" \
       -X POST http://localhost:10080/gl/haplotype -v && echo
}}}

<br/>
{{{
$ curl --header "content-type: text/plain" \
       --data "HLA-A*01:01:01:01+HLA-A*01:01:01:02N" \
       -X POST http://localhost:10080/gl/genotype -v && echo
}}}

<br/>
{{{
$ curl --header "content-type: text/plain" \
       --data "HLA-A*01:01:01:01+HLA-A*01:01:01:02N|HLA-DRB1*08:30:02~HLA-DRB3*02:02:01:01+HLA-DRB1*08:30:02~HLA-DRB5*01:12" \
       -X POST http://localhost:10080/gl/genotype-list -v && echo
}}}

<br/>
{{{
$ curl --header "content-type: text/plain" \
       --data "HLA-A*02:01:44+HLA-A*24:20^HLA-B*15:29+HLA-B*82:02^HLA-C*05:42+HLA-C*12:13^HLA-DRB1*12:06~HLA-DRB4*01:03:01:01+HLA-DRB1*10:01:01~HLA-DRB3*02:02:03^HLA-DQB1*03:03:02:02+HLA-DQB1*06:15" \
       -X POST http://localhost:10080/gl/multilocus-unphased-genotype -v && echo
}}}